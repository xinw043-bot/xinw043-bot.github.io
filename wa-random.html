<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Connect on WhatsApp</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #f0f2f5;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            text-align: center;
        }
        .container {
            background: white;
            padding: 30px 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            max-width: 400px;
            width: 100%;
        }
        
        /* 头部图标 */
        .icon-svg { margin-bottom: 15px; }
        
        h2 { color: #333; margin-bottom: 10px; font-size: 22px; }
        p { color: #666; margin-bottom: 25px; font-size: 16px; line-height: 1.5; }
        
        /* 通用按钮样式 */
        .btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            padding: 16px 0;
            color: white;
            text-decoration: none;
            font-weight: bold;
            font-size: 18px;
            border-radius: 30px;
            margin-bottom: 15px;
            cursor: pointer;
            border: none;
            -webkit-tap-highlight-color: transparent;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            transition: opacity 0.2s;
        }
        .btn:active { opacity: 0.8; transform: scale(0.98); }

        /* 主按钮 (绿色) - 用于直接跳转 */
        .btn-primary { background-color: #25D366; }

        /* 复制按钮 (蓝色) - iOS 专用 */
        .btn-copy { 
            background-color: #0084ff; 
            margin-bottom: 10px; /* 稍微缩小间距 */
        }
        
        .loading { font-size: 13px; color: #999; margin-top: 10px; }
        
        /* 针对 iOS 的中文提示语样式 */
        .ios-hint-text {
            font-size: 13px;
            color: #d93025; /* 红色警示色，显眼 */
            background-color: #fff5f5;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #ffebeb;
            margin-top: 5px;
            line-height: 1.4;
            display: none; /* 默认隐藏 */
        }

        /* 专门用于显示号码的区域（可选，增加信任感） */
        .number-display {
            font-size: 14px;
            color: #555;
            margin-bottom: 20px;
            background: #f9f9f9;
            padding: 5px 10px;
            border-radius: 4px;
            display: inline-block;
        }
    </style>
</head>
<body>

    <div class="container">
        <!-- WhatsApp 图标 -->
        <svg class="icon-svg" width="60" height="60" viewBox="0 0 24 24" fill="#25D366" xmlns="http://www.w3.org/2000/svg">
            <path d="M17.472 14.382C17.112 14.202 15.344 13.332 15.013 13.213C14.682 13.094 14.441 13.034 14.2 13.394C13.959 13.754 13.269 14.564 13.058 14.804C12.848 15.044 12.638 15.074 12.278 14.894C11.918 14.714 10.758 14.334 9.383 13.109C8.308 12.15 7.583 10.966 7.373 10.606C7.163 10.246 7.35 10.051 7.53 9.871C7.69 9.711 7.886 9.455 8.066 9.245C8.246 9.035 8.306 8.885 8.426 8.645C8.546 8.405 8.486 8.195 8.411 8.045C8.336 7.895 7.646 6.196 7.361 5.506C7.081 4.832 6.796 4.922 6.586 4.922C6.391 4.922 6.166 4.907 5.941 4.907C5.716 4.907 5.356 4.997 5.056 5.327C4.756 5.657 3.9 6.467 3.9 8.117C3.9 9.767 5.101 11.372 5.281 11.612C5.461 11.852 7.771 15.418 11.311 16.948C12.152 17.308 12.809 17.524 13.323 17.687C14.167 17.955 14.937 17.917 15.545 17.826C16.219 17.726 17.622 16.976 17.914 16.151C18.206 15.326 18.206 14.621 18.116 14.471C18.026 14.321 17.786 14.261 17.426 14.081H17.472Z" fill="white"/>
        </svg>

        <h2 id="title-text">Chat on WhatsApp</h2>
        
        <!-- 显示分配的号码 (可选，增加信任) -->
        <div class="number-display">Support: <span id="disp-number">...</span></div>

        <p id="status-text">Click below to start chat</p>
        
        <!-- 按钮 A: 直接打开 (绿色) -->
        <a id="wa-link" href="#" target="_blank" class="btn btn-primary">Open WhatsApp</a>
        
        <!-- 按钮 B: 复制账号 (蓝色 - 默认隐藏，仅 iOS 显示) -->
        <button id="copy-btn" class="btn btn-copy" style="display:none;" onclick="copyNumber()">
            复制账号 (Copy Number)
        </button>
        
        <!-- iOS 专用提示语 -->
        <div id="ios-hint" class="ios-hint-text">
            如果WhatsApp跳转失败，请点击上方蓝色按钮复制业务员WhatsApp账号，手动添加好友继续探讨合作事业。
        </div>

        <div id="loading-text" class="loading">Loading...</div>
    </div>

    <script>
    const waNumbers = ["8613890174417", "8619994654895", "8618923713151"];
    const apiUrl = "https://xinw043-bot-github-io.vercel.app/api/log"; 

    // 1. 锁定号码逻辑
    let finalNumber = localStorage.getItem('assigned_wa');
    if (!finalNumber) {
        finalNumber = waNumbers[Math.floor(Math.random() * waNumbers.length)];
        localStorage.setItem('assigned_wa', finalNumber);
    }

    // 页面显示号码
    document.getElementById('disp-number').innerText = "+" + finalNumber;

    const message = encodeURIComponent("Hi I want to inquire about thermal imaging cameras");
    
    // 2. 环境检测
    const ua = navigator.userAgent || navigator.vendor || window.opera;
    const isAndroid = /Android/i.test(ua);
    const isIOS = /iPhone|iPad|iPod/i.test(ua);
    
    // 3. 链接生成
    const androidLink = `whatsapp://send?phone=${finalNumber}&text=${message}`;
    const iosLink = `https://api.whatsapp.com/send?phone=${finalNumber}&text=${message}`; 
    const targetLink = isAndroid ? androidLink : iosLink;

    // 绑定主按钮
    const linkBtn = document.getElementById('wa-link');
    linkBtn.href = targetLink;

    // 4. 复制号码功能 (专门复制数字)
    function copyNumber() {
        const tempInput = document.createElement("input");
        tempInput.value = "+" + finalNumber; // 复制带+号的号码，方便用户直接搜索
        document.body.appendChild(tempInput);
        tempInput.select();
        document.execCommand("copy");
        document.body.removeChild(tempInput);
        
        // 按钮反馈
        const btn = document.ge
